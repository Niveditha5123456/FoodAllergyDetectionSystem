<!DOCTYPE html>
<html>
<head>
    <title>Food Allergy Detection</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</head>

<body>

<div class="container">
    <h2>Food Allergy Detection System</h2>

    <form id="allergyForm" method="POST" enctype="multipart/form-data" onsubmit="handleSubmit(event)">

        <!-- Name -->
        <label>Your Name:</label>
        <input type="text" name="name" required>

        <!-- Severity -->
        <label>Allergy Severity:</label>
        <select name="severity">
            <option value="mild">Mild</option>
            <option value="moderate">Moderate</option>
            <option value="severe">Severe</option>
        </select>

        <hr>

        <h3>Select Allergens</h3>

        <!-- MILK to ACIDIFIERS (Main Only) -->

        <div class="checkbox-group">
            <input type="checkbox" name="allergens" value="milk"> Milk <br>
            <input type="checkbox" name="allergens" value="egg"> Egg <br>
            <input type="checkbox" name="allergens" value="soy"> Soy <br>
            <input type="checkbox" name="allergens" value="peanut"> Peanut <br>
            <input type="checkbox" name="allergens" value="wheat"> Wheat <br>
            <input type="checkbox" name="allergens" value="sesame"> Sesame <br>
            <input type="checkbox" name="allergens" value="mustard"> Mustard <br>
            <input type="checkbox" name="allergens" value="celery"> Celery <br>
            <input type="checkbox" name="allergens" value="sulphites"> Sulphites <br>
            <input type="checkbox" name="allergens" value="lupin"> Lupin <br>
            <input type="checkbox" name="allergens" value="corn"> Corn <br>
            <input type="checkbox" name="allergens" value="chocolate"> Chocolate <br>
            <input type="checkbox" name="allergens" value="yeast"> Yeast <br>
            <input type="checkbox" name="allergens" value="caffeine"> Caffeine <br>
            <input type="checkbox" name="allergens" value="artificial colors"> Artificial Colors <br>
            <input type="checkbox" name="allergens" value="artificial preservatives"> Artificial Preservatives <br>
            <input type="checkbox" name="allergens" value="acidifiers"> Acidifiers <br>
        </div>

        <hr>

        <!-- FISH WITH SUBCATEGORY -->

        <div class="dropdown">
            <input type="checkbox" name="allergens" value="fish"> Fish
            <button type="button" onclick="toggle('fishList')">▼</button>

            <div id="fishList" class="dropdown-content">
                <input type="checkbox" name="allergens" value="salmon"> Salmon <br>
                <input type="checkbox" name="allergens" value="tuna"> Tuna <br>
                <input type="checkbox" name="allergens" value="cod"> Cod <br>
                <input type="checkbox" name="allergens" value="anchovy"> Anchovy <br>
                <input type="checkbox" name="allergens" value="haddock"> Haddock <br>
                <input type="checkbox" name="allergens" value="sardine"> Sardine <br>
                <input type="checkbox" name="allergens" value="trout"> Trout <br>
            </div>
        </div>

        <!-- SHELLFISH WITH SUBCATEGORY -->

        <div class="dropdown">
            <input type="checkbox" name="allergens" value="shellfish"> Shellfish
            <button type="button" onclick="toggle('shellList')">▼</button>

            <div id="shellList" class="dropdown-content">
                <input type="checkbox" name="allergens" value="shrimp"> Shrimp <br>
                <input type="checkbox" name="allergens" value="crab"> Crab <br>
                <input type="checkbox" name="allergens" value="lobster"> Lobster <br>
                <input type="checkbox" name="allergens" value="scallops"> Scallops <br>
                <input type="checkbox" name="allergens" value="lobster"> Lobster <br>
                <input type="checkbox" name="allergens" value="mussel"> Mussel <br>
                <input type="checkbox" name="allergens" value="oyster"> Oyster <br>
            </div>
        </div>

        <!-- TREE NUT WITH SUBCATEGORY -->

        <div class="dropdown">
            <input type="checkbox" name="allergens" value="tree nut"> Tree Nut
            <button type="button" onclick="toggle('nutList')">▼</button>

            <div id="nutList" class="dropdown-content">
                <input type="checkbox" name="allergens" value="almond"> Almond <br>
                <input type="checkbox" name="allergens" value="cashew"> Cashew <br>
                <input type="checkbox" name="allergens" value="walnut"> Walnut <br>
                <input type="checkbox" name="allergens" value="pecan"> Pecan <br>
                <input type="checkbox" name="allergens" value="pistachio"> Pistachio <br>
                <input type="checkbox" name="allergens" value="hazelnut"> Hazelnut <br>
                <input type="checkbox" name="allergens" value="macadamia"> Macadamia <br>
                <input type="checkbox" name="allergens" value="brazil nut"> Brazil Nut <br>
                <input type="checkbox" name="allergens" value="pine nut"> Pine Nut <br>
            </div>
        </div>

        <hr>

        <!-- IMAGE UPLOAD -->

        <label>Upload Food Label Image:</label>
        <input type="file" name="image" required>

        <br><br>

        <label>Upload Medical Report (Optional):</label>
        <input type="file" name="report">

        <br><br>

        <button type="submit" class="submit-btn">Scan</button>

    </form>

    <!-- RESULT SECTION -->

<div id="resultBox" class="result-box" style="display:none; margin-top:40px; padding:25px; background-color:#f9f9f9; border-radius:12px;">
    <h3 style="color:#333;">Scan Results</h3>
    
    <div style="margin-bottom:20px; padding:15px; background-color:#fffde7; border-left:4px solid #fbc02d; border-radius:4px;">
        <h4 style="color:#333; margin-top:0;">Allergen Names Found:</h4>
        <ul id="allergenList" style="padding-left:20px; color:#333; margin:10px 0;"></ul>
    </div>
    
    <div style="margin-bottom:20px; padding:15px; background-color:#e3f2fd; border-left:4px solid #2196f3; border-radius:4px;">
        <h4 style="color:#333; margin-top:0;">Severity Level:</h4>
        <p style="color:#333; font-size:18px; margin:10px 0;"><strong>Status: <span id="riskLevel" style="font-size:20px;"></span></strong></p>
    </div>
    
    <div class="stats-panel" style="margin-top:20px; padding:15px 20px; background-color:#f4f6f8; border-radius:10px; display:flex; gap:30px; flex-wrap:wrap;">
        <p style="color:#333; margin:8px 0;"><strong>Total Ingredients:</strong> <span id="totalCount" style="font-weight:bold; font-size:16px; color:#2196f3;"></span></p>
        <p style="color:#333; margin:8px 0;"><strong>Allergens Detected:</strong> <span id="allergenCount" style="font-weight:bold; font-size:16px; color:#ff6f00;"></span></p>
        <p style="color:#333; margin:8px 0;"><strong>Safety Percentage:</strong> <span id="safetyPercent" style="font-weight:bold; font-size:16px; color:#4caf50;"></span></p>
    </div>
</div>

</body>
</html>
